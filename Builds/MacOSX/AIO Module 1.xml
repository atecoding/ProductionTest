<?xml version="1.0" encoding="utf-8" ?>
<root>
  
  <!-- **************************************************** -->
	<!-- Echo Acoustic AIO                                    -->
	<!-- **************************************************** -->
	<device>
    Acoustic AIO
    <Require_AIO_Test_Adapter>true</Require_AIO_Test_Adapter>
    <ASIO_driver>EchoAIO</ASIO_driver>

    <message_box>Connect the Test Adapter to Inputs 1-4</message_box>

    <!-- Check constant current voltage and current -->

    <AIO_set_constant_current input="0" enabled="0" /> <!-- turn off constant current for input 1 -->
    <AIO_set_constant_current input="1" enabled="0" /> <!-- turn off constant current for input 2 -->
    <AIO_set_constant_current input="2" enabled="0" /> <!-- turn off constant current for input 3 -->
    <AIO_set_constant_current input="3" enabled="0" /> <!-- turn off constant current for input 4 -->
    <AIO_write_test_adapter byte="0x00"/> <!-- set adapter for Mic Supply voltage measurement and read ADCs-->
    <AIO_mic_supply_off_voltage_test input="0">
      <minimum>0.0</minimum> <!-- minimum and maximum are in volts -->
      <maximum>1.0</maximum>
    </AIO_mic_supply_off_voltage_test>

    <AIO_set_constant_current input="0" enabled="1" /> <!-- turn on constant current for input 1 -->
    <AIO_set_constant_current input="1" enabled="1" /> <!-- turn on constant current for input 2 -->
    <AIO_set_constant_current input="2" enabled="1" /> <!-- turn on constant current for input 3 -->
    <AIO_set_constant_current input="3" enabled="1" /> <!-- turn on constant current for input 4 -->
    <AIO_write_test_adapter byte="0x00"/> <!-- set adapter for Mic Supply voltage measurement and read ADCs-->
    <AIO_write_test_adapter byte="0x00"/> <!-- set adapter for Mic Supply voltage measurement and read ADCs-->
    <AIO_mic_supply_on_voltage_test input="0">
      <minimum>19.0</minimum> <!-- minimum and maximum are in volts -->
      <maximum>21.0</maximum>
    </AIO_mic_supply_on_voltage_test>

    <AIO_write_test_adapter byte="0x0f"/> <!-- set adapter for Mic Supply current measurement and read ADCs-->
    <AIO_write_test_adapter byte="0x0f"/> <!-- second time to allow capacitor discharge-->
    <AIO_mic_supply_current_test input="0">
      <minimum>4.0</minimum> <!-- minimum and maximum are in volts -->
      <maximum>4.4</maximum>
    </AIO_mic_supply_current_test>

    <AIO_set_constant_current input="0" enabled="0" /> <!-- turn off constant current for input 1 -->
    <AIO_set_constant_current input="1" enabled="0" /> <!-- turn off constant current for input 2 -->
    <AIO_set_constant_current input="2" enabled="0" /> <!-- turn off constant current for input 3 -->
    <AIO_set_constant_current input="3" enabled="0" /> <!-- turn off constant current for input 4 -->

    <!-- Check TEDS read circuits -->

    <AIO_TEDS_test input="0" />

    <!-- Test gain settings for inputs and outputs -->
    
    <AIO_write_test_adapter byte="0x30"/> <!-- set adapter for audio measurements-->
    
    <AIO_set_mic_gain input="0" gain="1" />
    <AIO_set_mic_gain input="1" gain="1" />
    <AIO_set_mic_gain input="2" gain="1" />
    <AIO_set_mic_gain input="3" gain="1" />

    <AIO_set_amp_gain output="0" gain="1" />
    <AIO_set_amp_gain output="1" gain="1" />

    <prompt>
      Input and Output Gains 1-4
      <text>Check levels for gain settings 1-4</text>
      <output_amplitude_db>0.0</output_amplitude_db>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_input_db>-200.0</min_input_db>
      <max_input_db>0.0</max_input_db>
      <wait_for_user>0</wait_for_user>
      <start_group>0</start_group>
    </prompt>

    <test>
      1x Input - 1x Output Level Check 1-2
      <type>Level check</type>
      <output_amplitude_db>-0.0</output_amplitude_db>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-25.0</min_level_db>
      <max_level_db>-20.0</max_level_db>
    </test>

    <test>
      1x Input - 1x Output Level Check 3-4
      <type>Level check</type>
      <output_amplitude_db>0.0</output_amplitude_db>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-25.0</min_level_db>
      <max_level_db>-20.0</max_level_db>
    </test>

    <AIO_set_mic_gain input="0" gain="1" />
    <AIO_set_mic_gain input="1" gain="1" />
    <AIO_set_mic_gain input="2" gain="1" />
    <AIO_set_mic_gain input="3" gain="1" />

    <AIO_set_amp_gain output="0" gain="10" />
    <AIO_set_amp_gain output="1" gain="10" />

    <test>
      1x Input - 10x Output Level Check 1-2
      <type>Level check</type>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-15.0</min_level_db>
      <max_level_db>-11.0</max_level_db>
    </test>

    <test>
      1x Input - 10x Output Level Check 3-4
      <type>Level check</type>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-15.0</min_level_db>
      <max_level_db>-11.0</max_level_db>
    </test>

    <AIO_set_mic_gain input="0" gain="10" />
    <AIO_set_mic_gain input="1" gain="10" />
    <AIO_set_mic_gain input="2" gain="10" />
    <AIO_set_mic_gain input="3" gain="10" />

    <AIO_set_amp_gain output="0" gain="10" />
    <AIO_set_amp_gain output="1" gain="10" />

    <test>
      10x Input - 10x Output Level Check 1-2
      <type>Level check</type>
      <output_amplitude_db>-30.0</output_amplitude_db>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-15.0</min_level_db>
      <max_level_db>-11.0</max_level_db>
    </test>

    <test>
      10x Input - 10x Output Level Check 3-4
      <type>Level check</type>
      <output_amplitude_db>-30.0</output_amplitude_db>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-15.0</min_level_db>
      <max_level_db>-11.0</max_level_db>
    </test>

    <AIO_set_mic_gain input="0" gain="100" />
    <AIO_set_mic_gain input="1" gain="100" />
    <AIO_set_mic_gain input="2" gain="100" />
    <AIO_set_mic_gain input="3" gain="100" />

    <AIO_set_amp_gain output="0" gain="1" />
    <AIO_set_amp_gain output="1" gain="1" />

    <test>
      100x Input - 1x Output Level Check 1-2
      <type>Level check</type>
      <output_amplitude_db>-30.0</output_amplitude_db>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-15.0</min_level_db>
      <max_level_db>-11.0</max_level_db>
    </test>

    <test>
      100x Input - 1x Output Level Check 3-4
      <type>Level check</type>
      <output_amplitude_db>-30.0</output_amplitude_db>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_level_db>-15.0</min_level_db>
      <max_level_db>-11.0</max_level_db>
    </test>

    <!-- Audio Quality Tests 1-4 -->

    <AIO_set_mic_gain input="0" gain="1" />
    <AIO_set_mic_gain input="1" gain="1" />
    <AIO_set_mic_gain input="2" gain="1" />
    <AIO_set_mic_gain input="3" gain="1" />

    <AIO_set_amp_gain output="0" gain="10" />
    <AIO_set_amp_gain output="1" gain="10" />

    <prompt>
      Audio Quality 1-4
      <text>Test Audio Quality 1-4</text>
      <output_amplitude_db>-20.0</output_amplitude_db>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_input_db>-200.0</min_input_db>
      <max_input_db>0.0</max_input_db>
      <wait_for_user>0</wait_for_user>
    </prompt>

    <!-- THD+N and DNR Channels 1-2 -->

    <test>
      Output 1 to Inputs 1 and 2
      <type>Differential THD+N</type>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <pass_threshold_db>-80.0</pass_threshold_db>
    </test>

    <test>
      <type>Differential Dynamic range</type>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-60.0</output_amplitude_db>
      <pass_threshold_db>105.0</pass_threshold_db>
    </test>

    <!-- Frequency response tests for 1-2 -->

    <test>
      <type>Frequency response</type>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>20.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>
    <test>
      <type>Frequency response</type>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>1000.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>
    <test>
      <type>Frequency response</type>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>10000.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>
    <test>
      <type>Frequency response</type>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>20000.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>

    <!-- THD+N and DNR Channels 3-4 -->

    <test>
      Output 2 to Inputs 3 and 4
      <type>Differential THD+N</type>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <pass_threshold_db>-80.0</pass_threshold_db>
    </test>

    <test>
      <type>Differential Dynamic range</type>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-60.0</output_amplitude_db>
      <pass_threshold_db>105.0</pass_threshold_db>
    </test>

    <!-- Frequency response tests for 3-4 -->

    <test>
      <type>Frequency response</type>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>20.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>
    <test>
      <type>Frequency response</type>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>1000.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>
    <test>
      <type>Frequency response</type>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>10000.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>
    <test>
      <type>Frequency response</type>
      <input>2</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <output_amplitude_db>-10.0</output_amplitude_db>
      <output_frequency>20000.0</output_frequency>
      <pass_threshold_db>-13.5</pass_threshold_db>
    </test>

    <prompt>
      Group End Prompt
      <text>Force printing of last result</text>
      <output_amplitude_db>-0.0</output_amplitude_db>
      <input>0</input>
      <output>0</output>
      <num_channels>2</num_channels>
      <sample_rate>48000</sample_rate>
      <min_input_db>-200.0</min_input_db>
      <max_input_db>0.0</max_input_db>
      <wait_for_user>0</wait_for_user>
      <stop_group>1</stop_group>
    </prompt>

  </device>

</root>

